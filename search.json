[{"path":"https://rasutt.github.io/ckutils/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2023 ckutils authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://rasutt.github.io/ckutils/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Robin Aldridge-Sutton. Author, maintainer.","code":""},{"path":"https://rasutt.github.io/ckutils/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Aldridge-Sutton R (2023). ckutils: Close-Kin Study Utilities. R package version 0.0.0.9000, https://rasutt.github.io/ckutils/.","code":"@Manual{,   title = {ckutils: Close-Kin Study Utilities},   author = {Robin Aldridge-Sutton},   year = {2023},   note = {R package version 0.0.0.9000},   url = {https://rasutt.github.io/ckutils/}, }"},{"path":"https://rasutt.github.io/ckutils/index.html","id":"ckutils","dir":"","previous_headings":"","what":"Close-Kin Study Utilities","title":"Close-Kin Study Utilities","text":"goal ckutils provide utilities close-kin study design implementation.","code":""},{"path":"https://rasutt.github.io/ckutils/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Close-Kin Study Utilities","text":"can install development version ckutils GitHub :","code":"# install.packages(\"devtools\") devtools::install_github(\"rasutt/ckutils\")"},{"path":"https://rasutt.github.io/ckutils/index.html","id":"example","dir":"","previous_headings":"","what":"Example","title":"Close-Kin Study Utilities","text":"basic example shows simulate wildlife population sampling-survey study .","code":""},{"path":"https://rasutt.github.io/ckutils/index.html","id":"simulation-years-and-expected-population-size","dir":"","previous_headings":"Example","what":"Simulation years and expected population size","title":"Close-Kin Study Utilities","text":"Close-kin studies use probabilities close family relationships pairs sampled animals (close-kin pairs). relationships defined breeding events occur prior sampling, ckutils lets specify number years simulate population prior final survey year. needs long enough relevant breeding events occur simulation. ckutils simulates populations expected population size grows constant factor called population growth rate λ. Specifying rate along expected population size N reference year defines expected population size years. good check entire simulation, small population sizes can unsustainable, large ones slow simulate.","code":"# Load close-kin utilities package library(ckutils)  # Survey years and simulation length srvy_yrs = c(2010, 2015, 2020) sim_len = 50  # Population growth rate, and population size in reference year lambda = 1.05 ref_yr = 2010 exp_N_ref = 1500  # Simulation years fnl_yr = tail(srvy_yrs, 1) init_yr = fnl_yr - sim_len + 1 sim_yrs = init_yr:fnl_yr  # Expected population size over simulation years exp_N_init = exp_N_ref * lambda^(init_yr - ref_yr) exp_N_t = exp_N_init * lambda^(0:(sim_len - 1))  # Plot expected population size over simulation years plot_exp_pop(sim_yrs, exp_N_t, ref_yr, exp_N_ref, srvy_yrs)"},{"path":"https://rasutt.github.io/ckutils/index.html","id":"predicted-numbers-of-close-kin-pairs","dir":"","previous_headings":"Example","what":"Predicted numbers of close-kin pairs","title":"Close-Kin Study Utilities","text":"ckutils simulates populations animal survives one year next constant probability ϕ, becomes sexually mature age α. animal also constant probability p sampled survey (given alive year). parameters, along population survey parameters , allow approximations expected numbers various close-kin pairs among sampled animals. sufficient number pairs essential successful study. Predicted numbers kin-pairs sampled animals","code":"# Annual survival rate and age of sexual maturity phi = 0.9 alpha = 8  # Sampling probability p = 0.1  # Survey year indices s_yr_inds = seq_along(srvy_yrs)  # Number of surveys k = length(srvy_yrs)  # Per capita birth rate rho = lambda - phi  # Find expected numbers of kin-pairs in population exp_ns_kps = find_exp_ns_kps(   exp_N_t, s_yr_inds, phi, rho, lambda, alpha, srvy_yrs, k )  # Combine expected numbers of kin-pairs within and between surveys in one matrix exp_ns_kps_cmbd = cmbn_exp_ns_kps(exp_ns_kps, k)  # Find expected numbers of kin-pairs between sampled animals exp_ns_kps_smpd = find_exp_ns_kps_smpd(exp_ns_kps_cmbd, k, p)    # Make it a data frame with row and column-names exp_ns_kps_smpd_df = make_exp_ns_kps_smpd_df(srvy_yrs, exp_ns_kps_smpd)  # Display it nicely knitr::kable(   exp_ns_kps_smpd_df,    caption = \"Predicted numbers of kin-pairs between sampled animals\", )"},{"path":"https://rasutt.github.io/ckutils/index.html","id":"simulate-population-and-study","dir":"","previous_headings":"Example","what":"Simulate population and study","title":"Close-Kin Study Utilities","text":"ckutils simulates genetic inheritance biallelic single nucleotide polymorphisms (SNPs) parents offspring. number SNP loci simulated L, initial minor allele frequency (IMAF) can specified. larger L, informative genotypes simulated, better close-kin pairs can distinguished , slower simulation analysis , costly genotypes produce real-world samples. closer IMAF 0.5 informative SNP locus , real-world genotypes MAFs vary. genetic inheritance simulated ckutils probabilistic MAFs locus vary independently, rate decreases population size. also options specify biological scenarios additional capture probability females new offspring, temporary emigration males outside sampling areas, selection females offspring order time since last offspring.","code":"# Number of loci in genome L = 100  # Initial minor allele frequency imaf = 0.5  # Set random seed for testing # set.seed(1)  # Simulate one population and study pop_study = sim_pop_study(   phi, lambda, exp_N_init, sim_len, srvy_yrs, k, fnl_yr, p, L, imaf,    clvng.p = 0, tmp.emgn = 0, alpha = alpha, clvng.ints = F )  # Look at it head(pop_study) #>      ID mum dad C2010 C2015 C2020 Cvg2010 Cvg2015 Cvg2020 #> 8     8  NA  NA     1     0     0       1       1       0 #> 264 264  14  37     0     0     1       1       1       1 #> 354 354 125  76     1     0     0       0       0       0 #> 373 373  46  72     0     1     0       1       1       1 #> 404 404  32 102     1     0     0       1       0       0 #> 727 727 348 105     0     0     1       1       1       1 names(attributes(pop_study)) #>  [1] \"names\"       \"row.names\"   \"class\"       \"avg.phi.obs\" \"beta\"        #>  [6] \"N.t.vec\"     \"ns.caps\"     \"Ns\"          \"ns.clvng\"    \"alive\"       #> [11] \"alv.s.yrs\"   \"f.age\"       \"mum\"         \"dad\"         \"ID\"          #> [16] \"ind.gts\""},{"path":"https://rasutt.github.io/ckutils/reference/cmbn_exp_ns_kps.html","id":null,"dir":"Reference","previous_headings":"","what":"Combine expected numbers of kin-pairs within and between surveys in one\nmatrix — cmbn_exp_ns_kps","title":"Combine expected numbers of kin-pairs within and between surveys in one\nmatrix — cmbn_exp_ns_kps","text":"Combine expected numbers kin-pairs within surveys one matrix","code":""},{"path":"https://rasutt.github.io/ckutils/reference/cmbn_exp_ns_kps.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Combine expected numbers of kin-pairs within and between surveys in one\nmatrix — cmbn_exp_ns_kps","text":"","code":"cmbn_exp_ns_kps(exp_ns_kps, k)"},{"path":"https://rasutt.github.io/ckutils/reference/cmbn_exp_ns_kps.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Combine expected numbers of kin-pairs within and between surveys in one\nmatrix — cmbn_exp_ns_kps","text":"exp_ns_kps Expected numbers kin-pairs, output find_exp_ns_kps. list two matrices, rows survey-years one pairs survey-years, one columns kinship-types k Number survey-years","code":""},{"path":"https://rasutt.github.io/ckutils/reference/cmbn_exp_ns_kps.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Combine expected numbers of kin-pairs within and between surveys in one\nmatrix — cmbn_exp_ns_kps","text":"matrix rows survey years pairs, columns kin-pair types","code":""},{"path":"https://rasutt.github.io/ckutils/reference/find_exp_ns_kps.html","id":null,"dir":"Reference","previous_headings":"","what":"Find expected numbers of kin-pairs in population — find_exp_ns_kps","title":"Find expected numbers of kin-pairs in population — find_exp_ns_kps","text":"Find expected numbers kin-pairs population","code":""},{"path":"https://rasutt.github.io/ckutils/reference/find_exp_ns_kps.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Find expected numbers of kin-pairs in population — find_exp_ns_kps","text":"","code":"find_exp_ns_kps(exp.N.t, s.yr.inds, phi, rho, lambda, alpha, srvy.yrs, k)"},{"path":"https://rasutt.github.io/ckutils/reference/find_exp_ns_kps.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Find expected numbers of kin-pairs in population — find_exp_ns_kps","text":"exp.N.t Expected population size time s.yr.inds Survey-year indices phi Individual survival rate rho Per capita birth rate lambda Population growth rate alpha Age sexual maturity srvy.yrs Survey-years k Number survey-years","code":""},{"path":"https://rasutt.github.io/ckutils/reference/find_exp_ns_kps.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Find expected numbers of kin-pairs in population — find_exp_ns_kps","text":"list two matrices, rows kinship-types, one columns survey-years one pairs survey-years.","code":""},{"path":"https://rasutt.github.io/ckutils/reference/find_exp_ns_kps.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Find expected numbers of kin-pairs in population — find_exp_ns_kps","text":"","code":"find_exp_ns_kps(   exp.N.t = 20*1.05^(1:20), s.yr.inds = 1:2, phi = 0.9, rho = 0.15,   lambda = 1.05, alpha = 5, srvy.yrs = c(18, 20), k = 2 ) #> $wtn #>      N.s.yrs      APs     POPs     SMPs     SFPs     FSPs     HSPs #> [1,]   21.00 210.0000 24.93750 27.35514 28.00031 4.102449 47.15056 #> [2,]   22.05 232.0763 26.18438 28.72290 29.41366 4.102449 49.93166 #>  #> $btn #>         APs   SPs     POPs     SMPs SMPs.kwn.age     SFPs     FSPs     HSPs #> [1,] 463.05 17.01 52.09875 56.82054    0.3904464 56.61519 8.093546 97.24864 #>"},{"path":"https://rasutt.github.io/ckutils/reference/find_exp_ns_kps_smpd.html","id":null,"dir":"Reference","previous_headings":"","what":"Find expected numbers of kin-pairs between sampled animals — find_exp_ns_kps_smpd","title":"Find expected numbers of kin-pairs between sampled animals — find_exp_ns_kps_smpd","text":"Find expected numbers kin-pairs sampled animals","code":""},{"path":"https://rasutt.github.io/ckutils/reference/find_exp_ns_kps_smpd.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Find expected numbers of kin-pairs between sampled animals — find_exp_ns_kps_smpd","text":"","code":"find_exp_ns_kps_smpd(exp_ns_kps_cmbd, k, p)"},{"path":"https://rasutt.github.io/ckutils/reference/find_exp_ns_kps_smpd.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Find expected numbers of kin-pairs between sampled animals — find_exp_ns_kps_smpd","text":"exp_ns_kps_cmbd Expected numbers kin-pairs, output cmbn_exp_ns_kps. matrix rows survey years pairs, columns kin-pair types k Number survey-years p Sampling probability","code":""},{"path":"https://rasutt.github.io/ckutils/reference/find_exp_ns_kps_smpd.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Find expected numbers of kin-pairs between sampled animals — find_exp_ns_kps_smpd","text":"matrix rows survey years pairs, columns kin-pair types","code":""},{"path":"https://rasutt.github.io/ckutils/reference/make_exp_ns_kps_smpd_df.html","id":null,"dir":"Reference","previous_headings":"","what":"Make data frame for expected numbers of kin-pairs between sampled animals — make_exp_ns_kps_smpd_df","title":"Make data frame for expected numbers of kin-pairs between sampled animals — make_exp_ns_kps_smpd_df","text":"Make data frame expected numbers kin-pairs sampled animals","code":""},{"path":"https://rasutt.github.io/ckutils/reference/make_exp_ns_kps_smpd_df.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Make data frame for expected numbers of kin-pairs between sampled animals — make_exp_ns_kps_smpd_df","text":"","code":"make_exp_ns_kps_smpd_df(srvy_yrs, exp_ns_kps_smpd)"},{"path":"https://rasutt.github.io/ckutils/reference/make_exp_ns_kps_smpd_df.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Make data frame for expected numbers of kin-pairs between sampled animals — make_exp_ns_kps_smpd_df","text":"exp_ns_kps_smpd Expected numbers kin-pairs sampled animals, output exp_ns_kps_smpd. matrix rows survey years pairs, columns kin-pair types","code":""},{"path":"https://rasutt.github.io/ckutils/reference/make_exp_ns_kps_smpd_df.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Make data frame for expected numbers of kin-pairs between sampled animals — make_exp_ns_kps_smpd_df","text":"data frame row column-names","code":""},{"path":"https://rasutt.github.io/ckutils/reference/plot_exp_pop.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot expected population size over time — plot_exp_pop","title":"Plot expected population size over time — plot_exp_pop","text":"Plot expected population size time","code":""},{"path":"https://rasutt.github.io/ckutils/reference/plot_exp_pop.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot expected population size over time — plot_exp_pop","text":"","code":"plot_exp_pop(sim_yrs, exp_N_t, ref_yr, exp_N_ref, srvy_yrs)"},{"path":"https://rasutt.github.io/ckutils/reference/plot_exp_pop.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot expected population size over time — plot_exp_pop","text":"sim_yrs Years population simulated exp_N_t Expected population size year ref_yr reference year expected population size defined exp_N_ref Expected population size reference year srvy_yrs Survey years","code":""},{"path":"https://rasutt.github.io/ckutils/reference/plot_exp_pop.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot expected population size over time — plot_exp_pop","text":"","code":"# Survey years and simulation length srvy_yrs = c(2010, 2015, 2020) sim_len = 50  # Population growth rate, and population size in reference year lambda = 1.05 ref_yr = 2010 exp_N_ref = 1500  # Simulation years fnl_yr = tail(srvy_yrs, 1) init_yr = fnl_yr - sim_len + 1 sim_yrs = init_yr:fnl_yr  # Expected population size over simulation years exp_N_init = exp_N_ref * lambda^(init_yr - ref_yr) exp_N_t = exp_N_init * lambda^(0:(sim_len - 1))  # Plot expected population size over simulation years plot_exp_pop(sim_yrs, exp_N_t, ref_yr, exp_N_ref, srvy_yrs)"},{"path":"https://rasutt.github.io/ckutils/reference/sim_pop_study.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate a population and a study of it — sim_pop_study","title":"Simulate a population and a study of it — sim_pop_study","text":"Simulate population study ","code":""},{"path":"https://rasutt.github.io/ckutils/reference/sim_pop_study.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate a population and a study of it — sim_pop_study","text":"","code":"sim_pop_study(   phi,   lambda,   N.init,   hist.len,   srvy.yrs,   k,   f.year,   p,   L,   imaf,   clvng.p,   tmp.emgn,   alpha,   clvng.ints )"},{"path":"https://rasutt.github.io/ckutils/reference/sim_pop_study.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate a population and a study of it — sim_pop_study","text":"phi individual survival rate lambda population growth rate N.init Initial population size hist.len Length simulation srvy.yrs Survey years k Number survey years f.year Final year simulation p Capture probability L Number genotype loci imaf Initial minor allele frequency clvng.p Additional calving probability tmp.emgn Rate temporary immigration alpha Age sexual maturity clvng.ints Whether females selected calving time since last calving, producing intervals standard length","code":""},{"path":"https://rasutt.github.io/ckutils/reference/sim_pop_study.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate a population and a study of it — sim_pop_study","text":"dataframe ID, mum, dad, capture, calving columns, several attributes.","code":""},{"path":"https://rasutt.github.io/ckutils/reference/sim_pop_study.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulate a population and a study of it — sim_pop_study","text":"","code":"# Simulate one population and study pop_study = sim_pop_study(   phi = 0.9, lambda = 1.05, N.init = 20, hist.len = 20, srvy.yrs = 20, k = 1,   f.year = 20, p = 0.5, L = 10, imaf = 0.5, clvng.p = 0, tmp.emgn = 0,   alpha = 5, clvng.ints = FALSE )  # Look at it head(pop_study) #>    ID mum dad C20 Cvg20 #> 9   9  NA  NA   1     0 #> 14 14  NA  NA   1     0 #> 20 20  NA  NA   1     0 #> 34 34  18   9   1     0 #> 36 36   3  23   1     0 #> 40 40  25  10   1     0 names(attributes(pop_study)) #>  [1] \"names\"       \"row.names\"   \"class\"       \"avg.phi.obs\" \"beta\"        #>  [6] \"N.t.vec\"     \"ns.caps\"     \"Ns\"          \"ns.clvng\"    \"alive\"       #> [11] \"alv.s.yrs\"   \"f.age\"       \"mum\"         \"dad\"         \"ID\"          #> [16] \"ind.gts\""}]
